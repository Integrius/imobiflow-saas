<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Tenancy | ImobiFlow SaaS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #8FD14F 0%, #006D77 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #8FD14F 0%, #006D77 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }

        header h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        header p {
            font-size: 1.3em;
            opacity: 0.95;
        }

        .breadcrumb {
            background: #f8f9fa;
            padding: 15px 40px;
            border-bottom: 1px solid #dee2e6;
        }

        .breadcrumb a {
            color: #006D77;
            text-decoration: none;
            margin-right: 10px;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .content {
            padding: 60px 40px;
        }

        h2 {
            color: #2c3e50;
            margin: 40px 0 20px 0;
            font-size: 2.2em;
            border-left: 5px solid #8FD14F;
            padding-left: 20px;
        }

        h3 {
            color: #34495e;
            margin: 30px 0 15px 0;
            font-size: 1.6em;
        }

        p {
            line-height: 1.8;
            color: #555;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .architecture-diagram {
            background: #f8f9fa;
            border: 2px solid #8FD14F;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            overflow-x: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: #8FD14F;
            color: white;
            padding: 15px;
            text-align: left;
            font-size: 1.1em;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .feature-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 30px;
            transition: all 0.3s;
        }

        .feature-card:hover {
            border-color: #8FD14F;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(143, 209, 79, 0.2);
        }

        .feature-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .feature-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .feature-card p {
            color: #666;
            font-size: 0.95em;
        }

        .code-block {
            background: #2c3e50;
            color: #fff;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .code-block .comment {
            color: #95a5a6;
        }

        .code-block .keyword {
            color: #8FD14F;
        }

        .code-block .string {
            color: #e74c3c;
        }

        .highlight-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
        }

        .highlight-box h3 {
            color: #856404;
            margin-top: 0;
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
        }

        .success-box h3 {
            color: #155724;
            margin-top: 0;
        }

        .example-flow {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .example-flow h4 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .flow-step {
            background: white;
            border-left: 4px solid #8FD14F;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .flow-step strong {
            color: #006D77;
        }

        .tenant-visual {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .tenant-box {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 3px solid #8FD14F;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(143, 209, 79, 0.2);
        }

        .tenant-box h4 {
            color: #006D77;
            margin-bottom: 20px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tenant-box .emoji {
            font-size: 1.5em;
        }

        .tenant-box ul {
            list-style: none;
            padding: 0;
        }

        .tenant-box li {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tenant-box li:last-child {
            border-bottom: none;
        }

        .tenant-box .label {
            color: #666;
            font-size: 0.9em;
        }

        .tenant-box .value {
            color: #2c3e50;
            font-weight: bold;
        }

        .back-link {
            display: inline-block;
            background: #8FD14F;
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            text-decoration: none;
            margin: 30px 0;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: #006D77;
            transform: scale(1.05);
        }

        footer {
            background: #2c3e50;
            color: white;
            padding: 40px;
            text-align: center;
        }

        footer p {
            color: #ecf0f1;
            margin-bottom: 10px;
        }

        .isolation-diagram {
            background: white;
            border: 2px solid #8FD14F;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            text-align: center;
        }

        .isolation-level {
            display: inline-block;
            background: linear-gradient(135deg, #8FD14F 0%, #006D77 100%);
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            margin: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¢ Multi-Tenancy</h1>
            <p>Arquitetura SaaS com Isolamento Completo por Cliente</p>
        </header>

        <div class="breadcrumb">
            <a href="guia-index.html">â† Voltar ao Ãndice</a> / Multi-Tenancy
        </div>

        <div class="content">
            <h2>ğŸ¯ O Que Ã‰ Multi-Tenancy?</h2>
            <p>
                <strong>Multi-tenancy</strong> Ã© uma arquitetura de software onde <strong>uma Ãºnica instÃ¢ncia da aplicaÃ§Ã£o serve mÃºltiplos clientes (tenants)</strong>,
                mantendo os dados de cada cliente <strong>completamente isolados e seguros</strong>.
            </p>

            <p>
                No ImobiFlow, cada <strong>imobiliÃ¡ria Ã© um tenant independente</strong> com:
            </p>

            <div class="feature-grid">
                <div class="feature-card">
                    <div class="icon">ğŸ“</div>
                    <h4>WhatsApp PrÃ³prio</h4>
                    <p>Cada cliente conecta seu prÃ³prio nÃºmero de WhatsApp Business para automaÃ§Ã£o.</p>
                </div>

                <div class="feature-card">
                    <div class="icon">ğŸ‘¥</div>
                    <h4>Leads Isolados</h4>
                    <p>Leads de uma imobiliÃ¡ria nunca aparecem para outra. Isolamento total.</p>
                </div>

                <div class="feature-card">
                    <div class="icon">ğŸ </div>
                    <h4>PortfÃ³lio PrÃ³prio</h4>
                    <p>Cada imobiliÃ¡ria gerencia seu prÃ³prio catÃ¡logo de imÃ³veis.</p>
                </div>

                <div class="feature-card">
                    <div class="icon">ğŸ‘¨â€ğŸ’¼</div>
                    <h4>Equipe Separada</h4>
                    <p>Corretores e usuÃ¡rios de cada empresa ficam isolados.</p>
                </div>

                <div class="feature-card">
                    <div class="icon">ğŸ¤–</div>
                    <h4>IA Personalizada</h4>
                    <p>Sofia pode ter personalidade e regras diferentes para cada cliente.</p>
                </div>

                <div class="feature-card">
                    <div class="icon">ğŸ“Š</div>
                    <h4>Dashboard Exclusivo</h4>
                    <p>EstatÃ­sticas e BI mostram apenas dados da prÃ³pria empresa.</p>
                </div>
            </div>

            <h2>ğŸ—ï¸ Arquitetura Multi-Tenant</h2>

            <div class="architecture-diagram">
ImobiFlow SaaS (Uma Ãšnica AplicaÃ§Ã£o)
â”‚
â”œâ”€ ğŸ¢ Tenant 1: ImobiliÃ¡ria ABC Ltda
â”‚  â”œâ”€ ğŸ“ WhatsApp: (11) 98888-8888
â”‚  â”œâ”€ ğŸ‘¥ Leads: 150
â”‚  â”œâ”€ ğŸ  ImÃ³veis: 80
â”‚  â”œâ”€ ğŸ‘¨â€ğŸ’¼ Corretores: 5
â”‚  â”œâ”€ ğŸ’° NegociaÃ§Ãµes: 120
â”‚  â”œâ”€ ğŸ¤– Sofia: Personalidade profissional
â”‚  â””â”€ ğŸ“Š Dashboard: MÃ©tricas prÃ³prias
â”‚
â”œâ”€ ğŸ¢ Tenant 2: ImobiliÃ¡ria XYZ S.A.
â”‚  â”œâ”€ ğŸ“ WhatsApp: (21) 97777-7777
â”‚  â”œâ”€ ğŸ‘¥ Leads: 200
â”‚  â”œâ”€ ğŸ  ImÃ³veis: 120
â”‚  â”œâ”€ ğŸ‘¨â€ğŸ’¼ Corretores: 8
â”‚  â”œâ”€ ğŸ’° NegociaÃ§Ãµes: 180
â”‚  â”œâ”€ ğŸ¤– Sofia: Personalidade descontraÃ­da
â”‚  â””â”€ ğŸ“Š Dashboard: MÃ©tricas prÃ³prias
â”‚
â””â”€ ğŸ¢ Tenant 3: ImÃ³veis Prime
   â”œâ”€ ğŸ“ WhatsApp: (48) 96666-6666
   â”œâ”€ ğŸ‘¥ Leads: 50
   â”œâ”€ ğŸ  ImÃ³veis: 30
   â”œâ”€ ğŸ‘¨â€ğŸ’¼ Corretores: 3
   â”œâ”€ ğŸ’° NegociaÃ§Ãµes: 40
   â”œâ”€ ğŸ¤– Sofia: Personalidade consultiva
   â””â”€ ğŸ“Š Dashboard: MÃ©tricas prÃ³prias

âœ… Cada tenant totalmente ISOLADO e INDEPENDENTE
            </div>

            <h2>ğŸ”’ Como Funciona o Isolamento?</h2>

            <h3>1. Banco de Dados - Campo `tenant_id`</h3>
            <p>
                <strong>TODAS as tabelas</strong> do banco de dados tÃªm um campo <code>tenant_id</code> que identifica a qual cliente pertence cada registro.
            </p>

            <div class="code-block">
<span class="comment">// Exemplo: Tabela de Leads</span>
<span class="keyword">model</span> Lead {
  id        String   @id @default(uuid())

  <span class="comment">// Campo que identifica o tenant</span>
  <span class="keyword">tenant_id</span> String  <span class="comment">â† Chave do isolamento!</span>
  tenant    Tenant   @relation(...)

  nome      String
  telefone  String
  email     String?
  score     Int

  @@<span class="keyword">index</span>([tenant_id])  <span class="comment">â† Ãndice para performance</span>
}
            </div>

            <h3>2. Middleware de AutenticaÃ§Ã£o</h3>
            <p>
                Quando vocÃª faz login, o sistema:
            </p>

            <div class="example-flow">
                <h4>Fluxo de AutenticaÃ§Ã£o:</h4>

                <div class="flow-step">
                    <strong>1. Login:</strong> UsuÃ¡rio envia email + senha
                </div>

                <div class="flow-step">
                    <strong>2. VerificaÃ§Ã£o:</strong> Sistema valida credenciais e identifica o tenant
                </div>

                <div class="flow-step">
                    <strong>3. Token JWT:</strong> Gera token contendo <code>userId</code> + <code>tenantId</code>
                </div>

                <div class="flow-step">
                    <strong>4. RequisiÃ§Ãµes:</strong> Todas as chamadas API incluem o token
                </div>

                <div class="flow-step">
                    <strong>5. Filtro AutomÃ¡tico:</strong> Sistema filtra TODOS os dados por <code>tenant_id</code>
                </div>
            </div>

            <div class="code-block">
<span class="comment">// Token JWT contÃ©m:</span>
{
  <span class="string">"userId"</span>: <span class="string">"abc-123"</span>,
  <span class="string">"tenantId"</span>: <span class="string">"tenant-xyz"</span>,  <span class="comment">â† Identifica a imobiliÃ¡ria</span>
  <span class="string">"email"</span>: <span class="string">"joao@imobiliariaABC.com"</span>
}

<span class="comment">// Todas as queries sÃ£o filtradas automaticamente:</span>
<span class="keyword">const</span> leads = <span class="keyword">await</span> prisma.lead.findMany({
  <span class="keyword">where</span>: {
    tenant_id: tenantId  <span class="comment">â† Sempre filtrado!</span>
  }
})
            </div>

            <h3>3. Isolamento em Todas as Camadas</h3>

            <div class="isolation-diagram">
                <div class="isolation-level">ğŸ—„ï¸ Banco de Dados</div>
                <div class="isolation-level">ğŸ”Œ API / Backend</div>
                <div class="isolation-level">ğŸ¨ Frontend / UI</div>
                <div class="isolation-level">ğŸ¤– IA / Sofia</div>
                <div class="isolation-level">ğŸ“± WhatsApp</div>
                <p style="margin-top: 30px; color: #2c3e50;">
                    <strong>Isolamento completo em TODAS as camadas!</strong>
                </p>
            </div>

            <h2>ğŸ¢ Exemplo PrÃ¡tico: 3 ImobiliÃ¡rias</h2>

            <div class="tenant-visual">
                <div class="tenant-box">
                    <h4><span class="emoji">ğŸ¢</span> ImobiliÃ¡ria ABC</h4>
                    <ul>
                        <li>
                            <span class="label">Tenant ID:</span>
                            <span class="value">tenant-001</span>
                        </li>
                        <li>
                            <span class="label">WhatsApp:</span>
                            <span class="value">(11) 98888-8888</span>
                        </li>
                        <li>
                            <span class="label">Leads:</span>
                            <span class="value">150 leads</span>
                        </li>
                        <li>
                            <span class="label">ImÃ³veis:</span>
                            <span class="value">80 imÃ³veis</span>
                        </li>
                        <li>
                            <span class="label">Corretores:</span>
                            <span class="value">5 corretores</span>
                        </li>
                        <li>
                            <span class="label">Sofia:</span>
                            <span class="value">Tom profissional</span>
                        </li>
                    </ul>
                </div>

                <div class="tenant-box">
                    <h4><span class="emoji">ğŸ¢</span> ImobiliÃ¡ria XYZ</h4>
                    <ul>
                        <li>
                            <span class="label">Tenant ID:</span>
                            <span class="value">tenant-002</span>
                        </li>
                        <li>
                            <span class="label">WhatsApp:</span>
                            <span class="value">(21) 97777-7777</span>
                        </li>
                        <li>
                            <span class="label">Leads:</span>
                            <span class="value">200 leads</span>
                        </li>
                        <li>
                            <span class="label">ImÃ³veis:</span>
                            <span class="value">120 imÃ³veis</span>
                        </li>
                        <li>
                            <span class="label">Corretores:</span>
                            <span class="value">8 corretores</span>
                        </li>
                        <li>
                            <span class="label">Sofia:</span>
                            <span class="value">Tom descontraÃ­do</span>
                        </li>
                    </ul>
                </div>

                <div class="tenant-box">
                    <h4><span class="emoji">ğŸ¢</span> ImÃ³veis Prime</h4>
                    <ul>
                        <li>
                            <span class="label">Tenant ID:</span>
                            <span class="value">tenant-003</span>
                        </li>
                        <li>
                            <span class="label">WhatsApp:</span>
                            <span class="value">(48) 96666-6666</span>
                        </li>
                        <li>
                            <span class="label">Leads:</span>
                            <span class="value">50 leads</span>
                        </li>
                        <li>
                            <span class="label">ImÃ³veis:</span>
                            <span class="value">30 imÃ³veis</span>
                        </li>
                        <li>
                            <span class="label">Corretores:</span>
                            <span class="value">3 corretores</span>
                        </li>
                        <li>
                            <span class="label">Sofia:</span>
                            <span class="value">Tom consultivo</span>
                        </li>
                    </ul>
                </div>
            </div>

            <h2>â“ Perguntas Frequentes</h2>

            <h3>1. Preciso de um nÃºmero WhatsApp novo?</h3>
            <div class="highlight-box">
                <p>
                    <strong>NÃƒO!</strong> VocÃª usa seu nÃºmero comercial atual. Conecta ele na API via QR Code (igual WhatsApp Web).
                    Cada tenant conecta seu prÃ³prio nÃºmero.
                </p>
            </div>

            <h3>2. Meus dados ficam misturados com outros clientes?</h3>
            <div class="success-box">
                <p>
                    <strong>JAMAIS!</strong> Isolamento 100% garantido. VocÃª NUNCA vÃª dados de outras imobiliÃ¡rias, e elas NUNCA veem os seus.
                    Ã‰ como ter seu prÃ³prio sistema exclusivo.
                </p>
            </div>

            <h3>3. A Sofia Ã© compartilhada entre clientes?</h3>
            <div class="highlight-box">
                <p>
                    <strong>NÃ£o!</strong> Cada tenant tem sua prÃ³pria "instÃ¢ncia" da Sofia. VocÃª pode personalizar:
                </p>
                <ul>
                    <li>Tom de voz (profissional, descontraÃ­do, consultivo)</li>
                    <li>Regras de qualificaÃ§Ã£o</li>
                    <li>HorÃ¡rio de atendimento</li>
                    <li>Limites de mensagens</li>
                    <li>CritÃ©rios de score</li>
                </ul>
            </div>

            <h3>4. Como sei que estou vendo apenas meus dados?</h3>
            <div class="success-box">
                <p>
                    O sistema usa seu <strong>token de autenticaÃ§Ã£o</strong> (JWT) que contÃ©m seu <code>tenant_id</code>.
                    <strong>TODAS</strong> as consultas ao banco de dados sÃ£o automaticamente filtradas por esse ID.
                    Ã‰ impossÃ­vel ver dados de outro tenant.
                </p>
            </div>

            <h3>5. O que acontece se um tenant apagar?</h3>
            <div class="highlight-box">
                <p>
                    Quando um tenant Ã© deletado, <strong>todos os dados relacionados</strong> sÃ£o deletados automaticamente (cascade delete):
                </p>
                <ul>
                    <li>Leads</li>
                    <li>ImÃ³veis</li>
                    <li>NegociaÃ§Ãµes</li>
                    <li>UsuÃ¡rios</li>
                    <li>Mensagens</li>
                    <li>HistÃ³rico completo</li>
                </ul>
                <p><strong>Outros tenants nÃ£o sÃ£o afetados.</strong></p>
            </div>

            <h2>ğŸ” SeguranÃ§a e Compliance</h2>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Aspecto</th>
                        <th>ImplementaÃ§Ã£o</th>
                        <th>BenefÃ­cio</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Isolamento de Dados</strong></td>
                        <td>Campo <code>tenant_id</code> em todas tabelas</td>
                        <td>ImpossÃ­vel acessar dados de outros clientes</td>
                    </tr>
                    <tr>
                        <td><strong>AutenticaÃ§Ã£o</strong></td>
                        <td>JWT com <code>tenantId</code> embutido</td>
                        <td>Filtro automÃ¡tico em todas requisiÃ§Ãµes</td>
                    </tr>
                    <tr>
                        <td><strong>LGPD</strong></td>
                        <td>Dados isolados por cliente</td>
                        <td>Conformidade com privacidade</td>
                    </tr>
                    <tr>
                        <td><strong>Backup</strong></td>
                        <td>PostgreSQL com backup automÃ¡tico</td>
                        <td>Dados seguros e recuperÃ¡veis</td>
                    </tr>
                    <tr>
                        <td><strong>Cascade Delete</strong></td>
                        <td>ExclusÃ£o automÃ¡tica de dados relacionados</td>
                        <td>NÃ£o deixa dados Ã³rfÃ£os</td>
                    </tr>
                </tbody>
            </table>

            <h2>âœ… Resumo Final</h2>

            <div class="success-box">
                <h3>Multi-Tenancy no ImobiFlow:</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>Uma aplicaÃ§Ã£o</strong> serve mÃºltiplos clientes
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>Isolamento total</strong> de dados por <code>tenant_id</code>
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>Cada cliente</strong> conecta seu prÃ³prio WhatsApp
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>Sofia personalizada</strong> para cada imobiliÃ¡ria
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>Dashboard exclusivo</strong> com mÃ©tricas prÃ³prias
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid #c3e6cb;">
                        âœ… <strong>SeguranÃ§a garantida</strong> - impossÃ­vel ver dados alheios
                    </li>
                    <li style="padding: 10px 0;">
                        âœ… <strong>EscalÃ¡vel</strong> - suporta centenas de imobiliÃ¡rias
                    </li>
                </ul>
            </div>

            <div style="text-align: center; margin: 50px 0;">
                <p style="font-size: 1.3em; color: #2c3e50; margin-bottom: 30px;">
                    <strong>Ã‰ como ter seu prÃ³prio sistema exclusivo, mas com custo e manutenÃ§Ã£o de SaaS! ğŸš€</strong>
                </p>
                <a href="guia-index.html" class="back-link">â† Voltar ao Ãndice de Guias</a>
            </div>
        </div>

        <footer>
            <p><strong>ImobiFlow SaaS</strong> - Multi-Tenancy Architecture</p>
            <p>Ãšltima atualizaÃ§Ã£o: 20 de Dezembro de 2025</p>
            <p>DocumentaÃ§Ã£o TÃ©cnica v1.0</p>
        </footer>
    </div>
</body>
</html>
